from common.helpers import register
from system_specific.system_info import SystemInfo

category = 'Cloud'


@register(['-pac'], 'Install awscli from pip', category + '/AWS')
def pip_awscli():
    SystemInfo().get_system_class().pip_install('awscli')


# TODO install dependencies
@register(['-cPr'], 'Clone repository Prowler', category + '/AWS')
def clone_Prowler():
    url = 'https://github.com/toniblyx/prowler.git'
    SystemInfo().get_system_class().clone_repo(url)


@register(['pSS'], 'Install ScoutSuite from pip', category + '/AWS')
def pip_ScoutSuite():
    SystemInfo().get_system_class().pip_install('scoutsuite')


@register(['-cGBB'], 'Clone repository GCPBucketBrute', category + '/GCP')
def clone_GCPBucketBrute():
    url = 'https://github.com/RhinoSecurityLabs/GCPBucketBrute.git'
    SystemInfo().get_system_class().clone_repo(url)


@register(['-cGIPE'], 'Clone repository GCP IAM Privilege Escalation', category + '/GCP')
def clone_GCPIamPrivilegeEscalation():
    url = 'https://github.com/RhinoSecurityLabs/GCP-IAM-Privilege-Escalation.git'
    SystemInfo().get_system_class().clone_repo(url)